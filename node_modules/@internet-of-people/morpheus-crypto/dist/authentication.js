"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const sdk_wasm_1 = require("@internet-of-people/sdk-wasm");
exports.didToAuth = (did) => {
    return new sdk_wasm_1.Did(did).defaultKeyId();
};
exports.isSameAuthentication = (left, right) => {
    // NOTE ugly implementation of double dispatch for both params
    if (left instanceof sdk_wasm_1.PublicKey) {
        if (right instanceof sdk_wasm_1.KeyId) {
            return left.validateId(right);
        }
        else {
            return left.toString() === right.toString();
        }
    }
    else {
        if (right instanceof sdk_wasm_1.KeyId) {
            return left.toString() === right.toString();
        }
        else {
            return right.validateId(left);
        }
    }
};
/** NOTE throws if conversion failed */
exports.authenticationFromData = (data) => {
    if (data.startsWith(sdk_wasm_1.KeyId.prefix())) {
        return new sdk_wasm_1.KeyId(data);
    }
    else {
        return new sdk_wasm_1.PublicKey(data);
    }
};
//# sourceMappingURL=authentication.js.map